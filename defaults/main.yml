---
dovecot_auth_mechanisms:
  - sql

dovecot_apt_packages:
  - dovecot-core
  - dovecot-common
  - dovecot-imapd
  - dovecot-pop3d
  - dovecot-lmtpd
  - dovecot-sieve
  - dovecot-managesieved

dovecot_dependencies:
  - procps

dovecot_default_vsz_limit: 1G
dovecot_default_process_limit: 1000
dovecot_default_client_limit: 10000
dovecot_mail_max_userip_connections: 10
dovecot_auth_worker_user: root

dovecot_service_process_min_avail: "{{ ansible_processor_cores * ansible_processor_count }}"
dovecot_service_restart_request_count: 1024

dovecot_mail_home: "{{ dovecot_vmail_path }}/%{user | domain | lower}/%{user | username | lower}"
dovecot_vmail_path: /var/vmail

dovecot_mail_uid: 5000
dovecot_mail_gid: "{{ dovecot_mail_uid }}"

dovecot_mail_plugins:
  - mail_crypt
  - quota
dovecot_mail_plugins_imap:
  - imap_quota
  - imap_sieve

dovecot_lda_mailbox_autosubscribe: "yes"
dovecot_lda_mail_plugins_extra:
  - sieve

# Mailbox settings
dovecot_junk_trash_autoexpunge: 30d
dovecot_mailboxes_extra: []
# dovecot_mailboxes_extra:
#   - name: Report spam
#     auto: subscribe
#     autoexpunge: "{{ dovecot_junk_trash_autoexpunge }}"
#     sieve_script:
#       report-spam:
#         cause: copy
#         path: "{{ dovecot_sieve_common_script_dir }}/report-spam.sieve"
#         type: before

dovecot_sieve_common_script_dir: /etc/dovecot/sieve
dovecot_sieve_personal_active_path: "~/.dovecot.sieve"
dovecot_sieve_max_actions: 32
dovecot_sieve_max_redirects: 20
dovecot_sieve_max_script_size: 1M
dovecot_sieve_quota_script_count: 10
dovecot_sieve_quota_storage_size: 1M
dovecot_sieve_recipient: spam@localhost
dovecot_sieve_redirect_envelope_from: orig_recipient

# dovecot_ssl_cert:
# dovecot_ssl_key:
dovecot_ssl_min_protocol: TLSv1.2

dovecot_postfix_auth: false

dovecot_quota_enforce: "yes"
dovecot_quota_storage: 1G

dovecot_metrics_enabled: false
dovecot_metrics_port: 9900

# enable dovecot backup
dovecot_backup_lead: false
dovecot_backup_follower: false

# backup script
dovecot_backup_script_path: "/root/sync_mailboxes_to_remote.sh"

# dovecot systemd environment
dovecot_systemd_environment: |
  # Set to '1' to allow Dovecot daemons to produce core dumps
  #ALLOW_COREDUMPS=1
