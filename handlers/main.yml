---
- name: Restart dovecot
  ansible.builtin.service:
    name: dovecot
    state: restarted

- name: Reload dovecot
  ansible.builtin.service:
    name: dovecot
    state: reloaded

- name: Reload systemd
  ansible.builtin.systemd:
    daemon_reload: true

- name: Compile sieve-before scripts # noqa no-changed-when
  ansible.builtin.command: /usr/bin/sievec /etc/dovecot/sieve-before
  notify:
    - Restart dovecot

- name: Compile imap-sieve scripts # noqa no-changed-when
  ansible.builtin.command: /usr/bin/sievec /etc/dovecot/imap-sieve
  notify:
    - Restart dovecot
